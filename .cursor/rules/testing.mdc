---
description: Только при написании тестов
alwaysApply: false
---
**Требования к тестированию**:
1. **Язык тестирования**: Python
2. **Тип тестов**: Функциональные (интеграционные) тесты
3. **Покрытие**: Все эндпоинты каждого микросервиса должны быть покрыты тестами
4. **Структура тестов**:
   - Тесты для каждого микросервиса в отдельной директории (например, `tests/services/auth/`, `tests/services/user/`, и т.д.)
   - Тесты для API Gateway в `tests/gateway/`
   - Каждый эндпоинт должен иметь отдельный тест-кейс
5. **Библиотеки для тестирования**:
   - `pytest` - основной фреймворк для тестирования
   - `requests` или `httpx` - для HTTP запросов к API
   - `websocket-client` или `websockets` - для тестирования WebSocket соединений
   - `pytest-docker` или `testcontainers` - для поднятия тестовых контейнеров (опционально)
6. **Сценарии тестирования**:
   - Успешные запросы (happy path)
   - Обработка ошибок (неверные данные, отсутствие авторизации, неверные права доступа)
   - Валидация входных данных
   - Проверка кодов ответов HTTP
   - Проверка структуры JSON ответов
7. **Запуск тестов**:
   - Тесты должны запускаться в изолированной среде (Docker контейнеры)
   - Использовать тестовую базу данных или моки
   - Тесты должны быть независимыми и идемпотентными
8. **Интеграция в CI/CD**:
   - Тесты должны запускаться автоматически при коммитах
   - Все тесты должны проходить перед мерджем в основную ветку

**Структура директории тестов**:
```
tests/
├── gateway/
│   └── test_gateway_endpoints.py
├── services/
│   ├── auth/
│   │   └── test_auth_endpoints.py
│   ├── user/
│   │   └── test_user_endpoints.py
│   ├── workspace/
│   │   └── test_workspace_endpoints.py
│   ├── chat/
│   │   ├── test_chat_endpoints.py
│   │   └── test_websocket.py
│   ├── task/
│   │   └── test_task_endpoints.py
│   └── complaint/
│       └── test_complaint_endpoints.py
├── conftest.py  # Общие фикстуры и настройки
└── requirements.txt  # Зависимости для тестов
```

**Приоритет тестирования**: Тесты должны разрабатываться параллельно с реализацией эндпоинтов или сразу после их реализации.